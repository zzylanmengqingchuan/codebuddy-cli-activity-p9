<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’• æ‹çˆ±å¤©æ•°è®¡ç®—å™¨ & ç‚«é…·3Dç…§ç‰‡å±•ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'PingFang SC', 'Helvetica Neue', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 25%, #fecfef 75%, #ff9a9e 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 182, 193, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 80% 80%, rgba(255, 105, 180, 0.3) 0%, transparent 40%);
            pointer-events: none;
            z-index: -1;
            animation: backgroundFloat 15s ease-in-out infinite;
        }

        @keyframes backgroundFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }

        .container {
            max-width: 450px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* æ‹çˆ±ä¿¡æ¯è¾“å…¥ç•Œé¢ */
        .love-info-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 35px;
            padding: 50px 35px;
            box-shadow: 0 25px 80px rgba(255, 105, 180, 0.4);
            backdrop-filter: blur(25px);
            border: 2px solid rgba(255, 182, 193, 0.4);
            animation: slideInUp 1s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(60px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #ff6b9d, #ff1744);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            font-weight: 800;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .subtitle {
            color: #777;
            font-size: 1.1rem;
            font-weight: 400;
        }

        .love-form {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .couple-inputs {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .input-group {
            flex: 1;
        }

        .input-group label {
            display: block;
            margin-bottom: 12px;
            color: #666;
            font-size: 1rem;
            font-weight: 600;
        }

        .input-group input {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid rgba(255, 182, 193, 0.4);
            border-radius: 30px;
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.4s ease;
            outline: none;
            font-weight: 500;
        }

        .input-group input:focus {
            border-color: #ff69b4;
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 0 30px rgba(255, 105, 180, 0.4);
            transform: translateY(-3px);
        }

        .heart-connector {
            font-size: 2.5rem;
            animation: heartBeat 2s ease-in-out infinite;
            margin-top: 30px;
            user-select: none;
            filter: drop-shadow(0 4px 8px rgba(255, 105, 180, 0.5));
        }

        @keyframes heartBeat {
            0%, 50%, 100% { transform: scale(1); }
            25%, 75% { transform: scale(1.3); }
        }

        .date-input-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .date-input-group label {
            color: #666;
            font-size: 1rem;
            font-weight: 600;
        }

        .date-input-group input {
            padding: 18px 24px;
            border: 2px solid rgba(255, 182, 193, 0.4);
            border-radius: 30px;
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.4s ease;
            outline: none;
            font-weight: 500;
        }

        .date-input-group input:focus {
            border-color: #ff69b4;
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 0 30px rgba(255, 105, 180, 0.4);
        }

        .upload-area {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 182, 193, 0.1));
            border: 3px dashed rgba(255, 105, 180, 0.6);
            border-radius: 25px;
            padding: 50px 25px;
            margin: 25px 0;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(15px);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .upload-area:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(255, 182, 193, 0.2));
            border-color: #ff1744;
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 105, 180, 0.3);
        }

        .upload-content {
            color: #666;
            position: relative;
            z-index: 1;
        }

        .upload-content svg {
            margin-bottom: 20px;
            opacity: 0.8;
            color: #ff69b4;
        }

        .upload-content p {
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .upload-hint {
            font-size: 1rem !important;
            opacity: 0.8;
            font-weight: 400 !important;
        }

        .demo-btn {
            background: linear-gradient(135deg, #ff6b9d, #ff1744);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(255, 105, 180, 0.4);
        }

        .demo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 105, 180, 0.6);
        }

        .uploaded-count {
            text-align: center;
            color: #666;
            font-size: 1.1rem;
            margin: 20px 0;
            padding: 15px 25px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 182, 193, 0.1));
            border-radius: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 182, 193, 0.3);
            font-weight: 600;
        }

        .create-wall-btn {
            background: linear-gradient(135deg, #ff6b9d, #ff1744);
            color: white;
            border: none;
            padding: 22px 35px;
            border-radius: 35px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: 700;
            box-shadow: 0 15px 40px rgba(255, 105, 180, 0.5);
            width: 100%;
            margin-top: 25px;
        }

        .create-wall-btn:disabled {
            background: linear-gradient(135deg, #ccc, #999);
            cursor: not-allowed;
            box-shadow: none;
        }

        .create-wall-btn:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: 0 20px 50px rgba(255, 105, 180, 0.6);
        }

        /* 3Då±•ç¤ºç•Œé¢ */
        .photo-wall-container {
            margin-top: 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .love-display {
            text-align: center;
            margin-bottom: 35px;
            padding: 35px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(255, 105, 180, 0.4);
            backdrop-filter: blur(25px);
            border: 2px solid rgba(255, 182, 193, 0.4);
        }

        .love-display .couple-names {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700;
            flex-wrap: wrap;
        }

        .love-display .name1, 
        .love-display .name2 {
            color: #ff1744;
            padding: 12px 20px;
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.3), rgba(255, 255, 255, 0.5));
            border-radius: 25px;
            border: 2px solid rgba(255, 105, 180, 0.4);
            backdrop-filter: blur(10px);
        }

        .love-display .love-symbol {
            font-size: 2.5rem;
            animation: heartBeat 2s ease-in-out infinite;
        }

        .love-days {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .love-text {
            color: #777;
            font-size: 1.3rem;
            font-weight: 500;
        }

        .love-days .days-number {
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b9d, #ff1744);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: numberPulse 3s ease-in-out infinite;
        }

        @keyframes numberPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .love-days .days-unit {
            font-size: 1.8rem;
            color: #ff1744;
            font-weight: 700;
        }

        /* æ§åˆ¶æŒ‰é’®åŒºåŸŸ */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 35px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 182, 193, 0.3);
            flex-wrap: wrap;
            gap: 20px;
            box-shadow: 0 10px 30px rgba(255, 105, 180, 0.2);
        }

        .control-btn {
            background: linear-gradient(135deg, #ff6b9d, #ff1744);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(255, 105, 180, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(255, 105, 180, 0.5);
        }

        .control-btn.secondary {
            background: rgba(255, 182, 193, 0.8);
            color: #ff1744;
        }

        /* 3Dç…§ç‰‡è½®æ’­å®¹å™¨ */
        .photo-wall-wrapper {
            perspective: 1500px;
            perspective-origin: center center;
            height: 80vh;
            min-height: 600px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            background: 
                linear-gradient(135deg, 
                    rgba(45, 45, 95, 0.95) 0%, 
                    rgba(70, 50, 120, 0.85) 30%, 
                    rgba(95, 75, 145, 0.75) 70%, 
                    rgba(120, 100, 170, 0.65) 100%),
                radial-gradient(circle at 30% 30%, rgba(255, 182, 193, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(138, 43, 226, 0.15) 0%, transparent 50%);
            border-radius: 30px;
            border: 2px solid rgba(255, 182, 193, 0.4);
            box-shadow: 
                0 25px 80px rgba(255, 105, 180, 0.4),
                0 15px 40px rgba(0, 0, 0, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.1);
        }

        /* 3Dè½®æ’­å®¹å™¨ */
        .photo-wall {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        /* 3Dè½®æ’­ç»„ */
        .carousel-3d {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 350px;
            height: 450px;
            transform-style: preserve-3d;
            animation: rotate3D 25s linear infinite;
        }

        .carousel-3d.paused {
            animation-play-state: paused;
        }

        /* 3Då¡ç‰‡ */
        .card-3d {
            position: absolute;
            width: 320px;
            height: 420px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 
                0 30px 100px rgba(0, 0, 0, 0.8),
                0 15px 50px rgba(0, 0, 0, 0.6),
                0 5px 20px rgba(0, 0, 0, 0.4),
                inset 0 2px 0 rgba(255, 255, 255, 0.8),
                inset 0 -2px 0 rgba(0, 0, 0, 0.1);
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            backdrop-filter: blur(20px) saturate(150%);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .card-3d::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.4) 0%, 
                    transparent 30%, 
                    rgba(255, 182, 193, 0.2) 70%, 
                    rgba(138, 43, 226, 0.1) 100%),
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.6) 0%, transparent 40%);
            pointer-events: none;
            z-index: 2;
            border-radius: 17px;
            opacity: 0.8;
        }

        .card-3d::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: 
                linear-gradient(45deg, 
                    rgba(255, 105, 180, 0.6) 0%, 
                    rgba(138, 43, 226, 0.4) 25%, 
                    rgba(75, 0, 130, 0.3) 50%, 
                    rgba(138, 43, 226, 0.4) 75%, 
                    rgba(255, 105, 180, 0.6) 100%);
            border-radius: 24px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.6s ease;
            filter: blur(15px);
        }

        .card-3d:hover {
            transform: scale(1.2) translateZ(120px) rotateY(15deg);
            box-shadow: 
                0 50px 150px rgba(0, 0, 0, 0.9),
                0 25px 80px rgba(0, 0, 0, 0.7),
                0 0 100px rgba(255, 105, 180, 0.8),
                0 0 50px rgba(138, 43, 226, 0.6),
                0 0 150px rgba(255, 182, 193, 0.4),
                inset 0 3px 0 rgba(255, 255, 255, 0.9),
                inset 0 -3px 0 rgba(0, 0, 0, 0.2);
            z-index: 1000;
            border: 3px solid rgba(255, 105, 180, 0.8);
        }

        .card-3d:hover::after {
            opacity: 1;
            animation: cardGlow 2s ease-in-out infinite;
        }

        .card-3d img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: 17px;
            transition: all 0.6s ease;
            position: relative;
            z-index: 1;
        }

        .card-3d:hover img {
            transform: scale(1.05);
            filter: brightness(1.15) saturate(1.3) contrast(1.1);
        }

        /* å¡ç‰‡ä¿¡æ¯è¦†ç›–å±‚ */
        .card-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: 
                linear-gradient(transparent, 
                    rgba(0, 0, 0, 0.8) 30%, 
                    rgba(0, 0, 0, 0.95) 100%);
            color: white;
            padding: 25px 20px 20px;
            transform: translateY(100%);
            transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 3;
        }

        .card-3d:hover .card-info {
            transform: translateY(0);
        }

        .card-info h3 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .card-info p {
            font-size: 0.95rem;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.8);
        }

        /* äº¤äº’æç¤º */
        .interaction-hint {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1rem;
            backdrop-filter: blur(15px);
            animation: hintFloat 8s ease-in-out infinite;
            pointer-events: none;
            font-weight: 500;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        @keyframes hintFloat {
            0%, 20%, 80%, 100% {
                opacity: 0.9;
                transform: translateX(-50%) translateY(0px);
            }
            40%, 60% {
                opacity: 0.4;
                transform: translateX(-50%) translateY(-5px);
            }
        }

        /* 3Dè½®æ’­åŠ¨ç”» */
        @keyframes rotate3D {
            0% {
                transform: translate(-50%, -50%) rotateY(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotateY(360deg);
            }
        }

        @keyframes cardGlow {
            0%, 100% {
                opacity: 0.8;
                transform: scale(1);
            }
            50% {
                opacity: 1;
                transform: scale(1.1);
            }
        }

        /* æµ®åŠ¨çˆ±å¿ƒæ•ˆæœ */
        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }

        .floating-heart {
            position: absolute;
            font-size: 1.8rem;
            opacity: 0.8;
            animation: floatUp 8s linear infinite;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) rotate(0deg) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
                transform: translateY(90vh) rotate(45deg) scale(0.6);
            }
            90% {
                opacity: 0.8;
                transform: translateY(10vh) rotate(315deg) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translateY(-10vh) rotate(360deg) scale(0.6);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .love-info-section, .photo-wall-container {
                padding: 30px 25px;
                border-radius: 25px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .couple-inputs {
                flex-direction: column;
                gap: 25px;
            }
            
            .heart-connector {
                margin-top: 0;
                font-size: 2rem;
            }
            
            .photo-wall-wrapper {
                height: 60vh;
                min-height: 400px;
            }
            
            .carousel-3d {
                width: 250px;
                height: 320px;
            }
            
            .card-3d {
                width: 220px;
                height: 300px;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,.4);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* éšè—å…ƒç´  */
        .hidden {
            display: none !important;
        }

        /* æ·¡å…¥åŠ¨ç”» */
        .fade-in {
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ‹çˆ±ä¿¡æ¯è¾“å…¥ç•Œé¢ -->
        <div class="love-info-section" id="loveInfoSection">
            <div class="header">
                <h1>ğŸ’• æˆ‘ä»¬çš„çˆ±æƒ…3Då›å¿†å¢™</h1>
                <p class="subtitle">è®°å½•æ¯ä¸€ä¸ªç¾å¥½ç¬é—´ï¼Œè®¡ç®—æˆ‘ä»¬çš„ç”œèœœæ—¶å…‰</p>
            </div>
            
            <div class="love-form">
                <div class="couple-inputs">
                    <div class="input-group">
                        <label for="name1">ğŸ‘« æˆ‘çš„åå­—</label>
                        <input type="text" id="name1" placeholder="è¾“å…¥ä½ çš„åå­—" maxlength="10">
                    </div>
                    <div class="heart-connector">ğŸ’•</div>
                    <div class="input-group">
                        <label for="name2">ğŸ‘« TAçš„åå­—</label>
                        <input type="text" id="name2" placeholder="è¾“å…¥TAçš„åå­—" maxlength="10">
                    </div>
                </div>
                
                <div class="date-input-group">
                    <label for="startDate">ğŸ“… åœ¨ä¸€èµ·çš„æ—¥æœŸ</label>
                    <input type="date" id="startDate" max="" required>
                </div>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        <p>ä¸Šä¼ æˆ‘ä»¬çš„ç¾å¥½å›å¿†</p>
                        <p class="upload-hint">æ”¯æŒ JPGã€PNG æ ¼å¼ï¼Œè‡³å°‘8å¼ ç…§ç‰‡</p>
                        <button type="button" id="demoBtn" class="demo-btn">ğŸ“¸ åŠ è½½æ¼”ç¤ºå›¾ç‰‡</button>
                    </div>
                    <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                </div>
                
                <div class="uploaded-count">
                    å·²ä¸Šä¼ : <span id="imageCount">0</span> å¼ å›¾ç‰‡
                </div>
                
                <button type="button" id="createWallBtn" class="create-wall-btn" disabled>
                    <span>ğŸ’–</span>
                    <span>åˆ›å»ºæˆ‘ä»¬çš„3Då›å¿†å¢™</span>
                    <span>ğŸ’–</span>
                </button>
            </div>
        </div>

        <!-- 3Dç…§ç‰‡å¢™å±•ç¤ºç•Œé¢ -->
        <div class="photo-wall-container" id="photoWallContainer" style="display: none;">
            <!-- æ‹çˆ±ä¿¡æ¯æ˜¾ç¤º -->
            <div class="love-display">
                <div class="couple-names">
                    <span class="name1" id="displayName1"></span>
                    <span class="love-symbol">ğŸ’•</span>
                    <span class="name2" id="displayName2"></span>
                </div>
                <div class="love-days">
                    <span class="love-text">æˆ‘ä»¬å·²ç»ç›¸çˆ±äº†</span>
                    <span class="days-number" id="daysNumber">520</span>
                    <span class="days-unit">å¤©</span>
                </div>
            </div>
            
            <div class="controls">
                <button id="resetBtn" class="control-btn secondary">ğŸ”„ é‡æ–°å¼€å§‹</button>
                <button id="pauseBtn" class="control-btn">â¸ï¸ æš‚åœæ—‹è½¬</button>
                <button id="speedUpBtn" class="control-btn">âš¡ åŠ é€Ÿ</button>
                <button id="slowDownBtn" class="control-btn">ğŸŒ å‡é€Ÿ</button>
                <button id="shareBtn" class="control-btn">ğŸ“± ç”Ÿæˆåˆ†äº«å›¾ç‰‡</button>
            </div>
            
            <div class="photo-wall-wrapper">
                <div class="photo-wall" id="photoWall">
                    <!-- 3Dç…§ç‰‡è½®æ’­å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="interaction-hint" id="interactionHint">
                    <p>ğŸ’« é¼ æ ‡æ‚¬åœæŸ¥çœ‹ç…§ç‰‡ | ç‚¹å‡»æš‚åœæ—‹è½¬</p>
                </div>
            </div>
        </div>
    </div>

    <!-- æµ®åŠ¨çˆ±å¿ƒæ•ˆæœ -->
    <div class="floating-hearts" id="floatingHearts"></div>

    <script>
        class Enhanced3DPhotoWall {
            constructor() {
                this.images = [];
                this.loveStartDate = null;
                this.coupleName1 = '';
                this.coupleName2 = '';
                this.animationSpeed = 1;
                this.isPaused = false;
                
                this.initializeElements();
                this.bindEvents();
                this.setupDateConstraints();
                this.startFloatingHearts();
            }

            initializeElements() {
                // ç•Œé¢å…ƒç´ 
                this.loveInfoSection = document.getElementById('loveInfoSection');
                this.photoWallContainer = document.getElementById('photoWallContainer');
                
                // è¾“å…¥å…ƒç´ 
                this.name1Input = document.getElementById('name1');
                this.name2Input = document.getElementById('name2');
                this.startDateInput = document.getElementById('startDate');
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.imageCount = document.getElementById('imageCount');
                this.createWallBtn = document.getElementById('createWallBtn');
                this.demoBtn = document.getElementById('demoBtn');
                
                // æ˜¾ç¤ºå…ƒç´ 
                this.displayName1 = document.getElementById('displayName1');
                this.displayName2 = document.getElementById('displayName2');
                this.daysNumber = document.getElementById('daysNumber');
                this.photoWall = document.getElementById('photoWall');
                
                // æ§åˆ¶å…ƒç´ 
                this.resetBtn = document.getElementById('resetBtn');
                this.pauseBtn = document.getElementById('pauseBtn');
                this.speedUpBtn = document.getElementById('speedUpBtn');
                this.slowDownBtn = document.getElementById('slowDownBtn');
                this.shareBtn = document.getElementById('shareBtn');
                
                // æµ®åŠ¨çˆ±å¿ƒå®¹å™¨
                this.floatingHearts = document.getElementById('floatingHearts');
            }

            bindEvents() {
                // ç…§ç‰‡ä¸Šä¼ äº‹ä»¶
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
                
                // æ‹–æ‹½ä¸Šä¼ äº‹ä»¶
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));
                
                // åˆ›å»ºç…§ç‰‡å¢™æŒ‰é’®
                this.createWallBtn.addEventListener('click', () => this.createPhotoWall());
                
                // æ¼”ç¤ºæŒ‰é’®
                this.demoBtn.addEventListener('click', () => this.loadDemoImages());
                
                // è¾“å…¥æ¡†å˜åŒ–äº‹ä»¶
                [this.name1Input, this.name2Input, this.startDateInput].forEach(input => {
                    input.addEventListener('input', () => this.validateInputs());
                });
                
                // æ§åˆ¶æŒ‰é’®äº‹ä»¶
                this.resetBtn.addEventListener('click', () => this.resetToStart());
                this.pauseBtn.addEventListener('click', () => this.togglePause());
                this.speedUpBtn.addEventListener('click', () => this.adjustSpeed(0.5));
                this.slowDownBtn.addEventListener('click', () => this.adjustSpeed(2));
                this.shareBtn.addEventListener('click', () => this.generateShareImage());
                
                // ç‚¹å‡»æš‚åœæ—‹è½¬
                this.photoWall.addEventListener('click', () => this.togglePause());
            }

            setupDateConstraints() {
                const today = new Date().toISOString().split('T')[0];
                this.startDateInput.setAttribute('max', today);
                
                // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä¸€å¹´å‰
                const oneYearAgo = new Date();
                oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
                this.startDateInput.value = oneYearAgo.toISOString().split('T')[0];
            }

            validateInputs() {
                const name1 = this.name1Input.value.trim();
                const name2 = this.name2Input.value.trim();
                const startDate = this.startDateInput.value;
                const hasImages = this.images.length >= 8;
                
                const isValid = name1 && name2 && startDate && hasImages;
                this.createWallBtn.disabled = !isValid;
            }

            // æ–‡ä»¶å¤„ç†æ–¹æ³•
            handleFileSelect(event) {
                const files = Array.from(event.target.files);
                this.processFiles(files);
            }

            handleDragOver(event) {
                event.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(event) {
                event.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(event) {
                event.preventDefault();
                this.uploadArea.classList.remove('dragover');
                const files = Array.from(event.dataTransfer.files);
                this.processFiles(files);
            }

            async processFiles(files) {
                const imageFiles = files.filter(file => file.type.startsWith('image/'));
                
                if (imageFiles.length === 0) {
                    this.showNotification('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼', 'warning');
                    return;
                }

                this.showLoading();

                for (const file of imageFiles) {
                    try {
                        const imageData = await this.loadImage(file);
                        this.images.push(imageData);
                        this.updateImageCount();
                    } catch (error) {
                        console.error('åŠ è½½å›¾ç‰‡å¤±è´¥:', error);
                    }
                }

                this.hideLoading();
                this.validateInputs();

                if (this.images.length >= 8) {
                    this.showNotification(`å¤ªæ£’äº†ï¼å·²ä¸Šä¼ ${this.images.length}å¼ ç…§ç‰‡ ğŸ’•`, 'success');
                } else {
                    this.showNotification(`è¿˜éœ€è¦${8 - this.images.length}å¼ ç…§ç‰‡æ‰èƒ½åˆ›å»ºç…§ç‰‡å¢™`, 'info');
                }
            }

            loadImage(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => {
                            resolve({
                                src: e.target.result,
                                name: file.name,
                                width: img.width,
                                height: img.height
                            });
                        };
                        img.onerror = reject;
                        img.src = e.target.result;
                    };
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            }

            showLoading() {
                this.uploadArea.querySelector('.upload-content').innerHTML = `
                    <div class="loading"></div>
                    <p>æ­£åœ¨åŠ è½½å›¾ç‰‡...</p>
                `;
            }

            hideLoading() {
                this.uploadArea.querySelector('.upload-content').innerHTML = `
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7,10 12,15 17,10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    <p>ä¸Šä¼ æˆ‘ä»¬çš„ç¾å¥½å›å¿†</p>
                    <p class="upload-hint">æ”¯æŒ JPGã€PNG æ ¼å¼ï¼Œè‡³å°‘8å¼ ç…§ç‰‡</p>
                    <button type="button" id="demoBtn" class="demo-btn">ğŸ“¸ åŠ è½½æ¼”ç¤ºå›¾ç‰‡</button>
                `;
                
                // é‡æ–°ç»‘å®šæ¼”ç¤ºæŒ‰é’®äº‹ä»¶
                const newDemoBtn = document.getElementById('demoBtn');
                if (newDemoBtn) {
                    newDemoBtn.addEventListener('click', () => this.loadDemoImages());
                }
            }

            updateImageCount() {
                this.imageCount.textContent = this.images.length;
            }

            async loadDemoImages() {
                this.showNotification('æ­£åœ¨ç”Ÿæˆæ¼”ç¤ºå›¾ç‰‡... ğŸ¨', 'info');
                
                const themes = [
                    { colors: ['#FF6B6B', '#4ECDC4'], name: 'æµ·æ´‹æ—¥è½', emoji: 'ğŸŒ…' },
                    { colors: ['#A8E6CF', '#FF8A80'], name: 'æ˜¥æ—¥èŠ±å›­', emoji: 'ğŸŒ¸' },
                    { colors: ['#FFD93D', '#6BCF7F'], name: 'é˜³å…‰è‰åœ°', emoji: 'ğŸŒ»' },
                    { colors: ['#A8EDEA', '#FED6E3'], name: 'æ¢¦å¹»äº‘å½©', emoji: 'â˜ï¸' },
                    { colors: ['#D299C2', '#FEF9D7'], name: 'è–°è¡£è‰ç”°', emoji: 'ğŸ’œ' },
                    { colors: ['#89F7FE', '#66A6FF'], name: 'è“è‰²æ¢¦å¢ƒ', emoji: 'ğŸ’™' },
                    { colors: ['#FDA085', '#F6D365'], name: 'é‡‘ç§‹æ—¶å…‰', emoji: 'ğŸ‚' },
                    { colors: ['#F093FB', '#F5576C'], name: 'ç«ç‘°èŠ±ç“£', emoji: 'ğŸŒ¹' },
                    { colors: ['#4FACFE', '#00F2FE'], name: 'å†°é›ªä¸–ç•Œ', emoji: 'â„ï¸' },
                    { colors: ['#43E97B', '#38F9D7'], name: 'ç¿¡ç¿ æ£®æ—', emoji: 'ğŸŒ²' }
                ];

                this.images = [];
                
                for (let i = 0; i < themes.length; i++) {
                    const theme = themes[i];
                    const canvas = document.createElement('canvas');
                    canvas.width = 400;
                    canvas.height = 500;
                    const ctx = canvas.getContext('2d');
                    
                    // åˆ›å»ºæ¸å˜èƒŒæ™¯
                    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                    gradient.addColorStop(0, theme.colors[0]);
                    gradient.addColorStop(1, theme.colors[1]);
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // æ·»åŠ è£…é¥°å…ƒç´ 
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
                    for (let j = 0; j < 20; j++) {
                        const x = Math.random() * canvas.width;
                        const y = Math.random() * canvas.height;
                        const size = Math.random() * 50 + 20;
                        ctx.beginPath();
                        ctx.arc(x, y, size, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    
                    // æ·»åŠ ä¸»é¢˜å›¾æ ‡
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.font = '120px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(theme.emoji, canvas.width / 2, canvas.height / 2 + 40);
                    
                    // æ·»åŠ ä¸»é¢˜åç§°
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                    ctx.font = 'bold 36px Arial';
                    ctx.fillText(theme.name, canvas.width / 2, canvas.height - 60);
                    
                    const dataURL = canvas.toDataURL('image/png');
                    this.images.push({
                        src: dataURL,
                        name: theme.name,
                        width: 400,
                        height: 500
                    });
                }
                
                this.updateImageCount();
                this.validateInputs();
                this.showNotification('æ¼”ç¤ºå›¾ç‰‡åŠ è½½å®Œæˆï¼ âœ¨', 'success');
            }

            createPhotoWall() {
                const name1 = this.name1Input.value.trim();
                const name2 = this.name2Input.value.trim();
                const startDate = this.startDateInput.value;

                if (!name1 || !name2 || !startDate || this.images.length < 8) {
                    this.showNotification('è¯·ç¡®ä¿æ‰€æœ‰ä¿¡æ¯éƒ½å·²å¡«å†™å®Œæ•´ï¼', 'warning');
                    return;
                }

                // ä¿å­˜æ‹çˆ±ä¿¡æ¯
                this.coupleName1 = name1;
                this.coupleName2 = name2;
                this.loveStartDate = new Date(startDate);

                // æ˜¾ç¤ºåŠ è½½
                this.createWallBtn.innerHTML = `
                    <div class="loading"></div>
                    <span>æ­£åœ¨åˆ›å»ºç‚«é…·3Då›å¿†å¢™...</span>
                `;
                this.createWallBtn.disabled = true;

                // å»¶è¿Ÿåˆ‡æ¢ç•Œé¢
                setTimeout(() => {
                    this.showPhotoWall();
                }, 2000);
            }

            showPhotoWall() {
                // æ›´æ–°æ‹çˆ±ä¿¡æ¯æ˜¾ç¤º
                this.displayName1.textContent = this.coupleName1;
                this.displayName2.textContent = this.coupleName2;
                
                // è®¡ç®—å¹¶åŠ¨ç”»æ˜¾ç¤ºæ‹çˆ±å¤©æ•°
                const today = new Date();
                const timeDiff = today.getTime() - this.loveStartDate.getTime();
                const daysDiff = Math.floor(timeDiff / (1000 * 3600 * 24));
                this.animateNumber(this.daysNumber, 0, daysDiff, 2000);
                
                // ç”Ÿæˆ3Dç…§ç‰‡å¢™
                this.generate3DPhotoWall();
                
                // åˆ‡æ¢ç•Œé¢
                this.loveInfoSection.style.display = 'none';
                this.photoWallContainer.style.display = 'block';
                this.photoWallContainer.classList.add('fade-in');
                
                // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
                this.showNotification(`ğŸ‰ ç‚«é…·3Då›å¿†å¢™åˆ›å»ºæˆåŠŸï¼ç›¸çˆ±äº† ${daysDiff} å¤©ï¼`, 'success');
                
                // æ»šåŠ¨åˆ°ç…§ç‰‡å¢™
                this.photoWallContainer.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }

            animateNumber(element, start, end, duration) {
                const startTime = performance.now();
                const range = end - start;

                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                    const currentValue = Math.floor(start + (range * easeOutQuart));
                    
                    element.textContent = currentValue;
                    
                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };
                
                requestAnimationFrame(animate);
            }

            generate3DPhotoWall() {
                this.photoWall.innerHTML = '';
                
                this.showNotification(`æ­£åœ¨ç”Ÿæˆç‚«é…·3Dè½®æ’­ç…§ç‰‡å¢™ - ${this.images.length}å¼ ç…§ç‰‡ âœ¨`, 'info');
                
                // åˆ›å»º3Dè½®æ’­å®¹å™¨
                const carousel = document.createElement('div');
                carousel.className = 'carousel-3d';
                
                // è®¡ç®—å¸ƒå±€
                const displayCount = Math.min(this.images.length, 8);
                const angleStep = 360 / displayCount;
                const radius = 450;
                
                for (let i = 0; i < displayCount; i++) {
                    const imageIndex = i % this.images.length;
                    const angle = i * angleStep;
                    const radian = (angle * Math.PI) / 180;
                    
                    const x = Math.sin(radian) * radius;
                    const z = Math.cos(radian) * radius;
                    
                    const card = this.createPhotoCard(this.images[imageIndex], {
                        transform: `translateZ(${z}px) translateX(${x}px) rotateY(${-angle}deg)`,
                        delay: i * 0.2
                    }, imageIndex);
                    
                    carousel.appendChild(card);
                }
                
                this.photoWall.appendChild(carousel);
                
                // å¦‚æœå›¾ç‰‡è¶…è¿‡8å¼ ï¼Œåˆ›å»ºè½®æ¢æœºåˆ¶
                if (this.images.length > 8) {
                    this.setupImageRotation(carousel, displayCount);
                }
                
                setTimeout(() => {
                    this.showNotification(`ç‚«é…·3Dè½®æ’­ç…§ç‰‡å¢™ç”Ÿæˆå®Œæˆï¼ğŸ‰`, 'success');
                }, 1500);
            }

            createPhotoCard(image, layout, index) {
                const card = document.createElement('div');
                card.className = 'card-3d';
                card.style.transform = layout.transform;
                card.style.opacity = '0';
                
                const img = document.createElement('img');
                img.src = image.src;
                img.alt = image.name;
                img.loading = 'lazy';
                
                // æ·»åŠ å¡ç‰‡ä¿¡æ¯
                const cardInfo = document.createElement('div');
                cardInfo.className = 'card-info';
                cardInfo.innerHTML = `
                    <h3>${image.name}</h3>
                    <p>ç¬¬ ${index + 1} å¼ ç…§ç‰‡ Â· æˆ‘ä»¬çš„ç¾å¥½å›å¿†</p>
                `;
                
                // å»¶è¿Ÿæ˜¾ç¤ºåŠ¨ç”»
                const delay = Math.min((layout.delay || 0), 1.6);
                setTimeout(() => {
                    card.style.transition = 'opacity 1s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                    card.style.opacity = '1';
                }, delay * 300);
                
                // ç‚¹å‡»äº‹ä»¶
                card.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.showImageModal(image);
                });
                
                card.appendChild(img);
                card.appendChild(cardInfo);
                return card;
            }

            setupImageRotation(carousel, displayCount) {
                let currentOffset = 0;
                
                this.imageRotationInterval = setInterval(() => {
                    if (this.photoWallContainer.style.display === 'none') return;
                    if (this.isPaused) return;
                    
                    currentOffset = (currentOffset + 1) % this.images.length;
                    
                    // æ›´æ–°æ¯å¼ å¡ç‰‡çš„å›¾ç‰‡
                    const cards = carousel.querySelectorAll('.card-3d');
                    cards.forEach((card, index) => {
                        const imageIndex = (currentOffset + index) % this.images.length;
                        const img = card.querySelector('img');
                        const info = card.querySelector('.card-info');
                        
                        if (img && this.images[imageIndex]) {
                            img.style.opacity = '0';
                            setTimeout(() => {
                                img.src = this.images[imageIndex].src;
                                img.alt = this.images[imageIndex].name;
                                info.innerHTML = `
                                    <h3>${this.images[imageIndex].name}</h3>
                                    <p>ç¬¬ ${imageIndex + 1} å¼ ç…§ç‰‡ Â· æˆ‘ä»¬çš„ç¾å¥½å›å¿†</p>
                                `;
                                img.style.opacity = '1';
                            }, 200);
                        }
                    });
                }, 5000);
            }

            showImageModal(image) {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.9);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                    cursor: pointer;
                    backdrop-filter: blur(15px);
                `;
                
                const img = document.createElement('img');
                img.src = image.src;
                img.style.cssText = `
                    max-width: 90%;
                    max-height: 90%;
                    object-fit: contain;
                    border-radius: 20px;
                    box-shadow: 0 30px 100px rgba(0, 0, 0, 0.8);
                    animation: modalZoomIn 0.5s ease;
                `;
                
                // æ·»åŠ æ¨¡æ€æ¡†åŠ¨ç”»
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes modalZoomIn {
                        from {
                            opacity: 0;
                            transform: scale(0.5);
                        }
                        to {
                            opacity: 1;
                            transform: scale(1);
                        }
                    }
                `;
                document.head.appendChild(style);
                
                modal.appendChild(img);
                document.body.appendChild(modal);
                
                modal.addEventListener('click', () => {
                    document.body.removeChild(modal);
                    document.head.removeChild(style);
                });
            }

            // æ§åˆ¶åŠŸèƒ½
            togglePause() {
                this.isPaused = !this.isPaused;
                const carousel = this.photoWall.querySelector('.carousel-3d');
                
                if (this.isPaused) {
                    this.pauseBtn.textContent = 'â–¶ï¸ ç»§ç»­æ—‹è½¬';
                    if (carousel) {
                        carousel.style.animationPlayState = 'paused';
                    }
                    this.showNotification('å·²æš‚åœæ—‹è½¬ â¸ï¸', 'info');
                } else {
                    this.pauseBtn.textContent = 'â¸ï¸ æš‚åœæ—‹è½¬';
                    if (carousel) {
                        carousel.style.animationPlayState = 'running';
                    }
                    this.showNotification('ç»§ç»­æ—‹è½¬ â–¶ï¸', 'info');
                }
            }

            adjustSpeed(factor) {
                this.animationSpeed *= factor;
                this.animationSpeed = Math.max(0.5, Math.min(this.animationSpeed, 3));
                
                const carousel = this.photoWall.querySelector('.carousel-3d');
                if (carousel) {
                    const duration = 25 / this.animationSpeed;
                    carousel.style.animationDuration = `${duration}s`;
                }
                
                const speedText = this.animationSpeed > 1 ? 'åŠ é€Ÿ' : this.animationSpeed < 1 ? 'å‡é€Ÿ' : 'æ­£å¸¸';
                this.showNotification(`æ—‹è½¬é€Ÿåº¦: ${speedText} ${factor < 1 ? 'âš¡' : 'ğŸŒ'}`, 'info');
            }

            async generateShareImage() {
                // å…ˆè®©ç”¨æˆ·é€‰æ‹©è¦å±•ç¤ºçš„ç…§ç‰‡
                if (this.images.length > 0) {
                    this.showPhotoSelectionModal();
                } else {
                    this.createShareImageWithPhoto(null);
                }
            }
            
            showPhotoSelectionModal() {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.85);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                    backdrop-filter: blur(15px);
                `;
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = `
                    background: white;
                    border-radius: 30px;
                    padding: 40px;
                    max-width: 650px;
                    width: 95%;
                    max-height: 85vh;
                    overflow-y: auto;
                    box-shadow: 0 30px 100px rgba(0, 0, 0, 0.6);
                    text-align: center;
                `;
                
                modalContent.innerHTML = `
                    <h3 style="color: #ff1744; font-size: 1.6rem; font-weight: 700; margin-bottom: 20px;">ğŸ’• é€‰æ‹©ä¸€å¼ æœ€å–œæ¬¢çš„ç…§ç‰‡</h3>
                    <p style="color: #666; margin-bottom: 30px;">è¿™å¼ ç…§ç‰‡å°†ä½œä¸ºåˆ†äº«å›¾çš„ä¸»è¦å±•ç¤ºå›¾ç‰‡</p>
                    <div id="photoGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-bottom: 30px;"></div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button id="skipPhotoBtn" style="padding: 12px 25px; border: 2px solid #ddd; border-radius: 25px; background: white; color: #666; cursor: pointer; font-weight: 600;">è·³è¿‡é€‰æ‹©</button>
                        <button id="cancelSelectionBtn" style="padding: 12px 25px; border: 2px solid #ff69b4; border-radius: 25px; background: white; color: #ff69b4; cursor: pointer; font-weight: 600;">å–æ¶ˆ</button>
                    </div>
                `;
                
                const photoGrid = modalContent.querySelector('#photoGrid');
                
                // æ·»åŠ ç…§ç‰‡é€‰é¡¹
                this.images.forEach((image, index) => {
                    const photoOption = document.createElement('div');
                    photoOption.style.cssText = `
                        cursor: pointer;
                        border: 3px solid transparent;
                        border-radius: 15px;
                        overflow: hidden;
                        transition: all 0.3s ease;
                        background: white;
                        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                    `;
                    
                    photoOption.innerHTML = `
                        <img src="${image.src}" style="width: 100%; height: 120px; object-fit: cover; display: block;">
                        <p style="padding: 8px; font-size: 0.9rem; color: #666; margin: 0;">${image.name}</p>
                    `;
                    
                    photoOption.addEventListener('click', () => {
                        document.body.removeChild(modal);
                        this.createShareImageWithPhoto(image);
                    });
                    
                    photoOption.addEventListener('mouseenter', () => {
                        photoOption.style.borderColor = '#ff69b4';
                        photoOption.style.transform = 'translateY(-5px)';
                        photoOption.style.boxShadow = '0 10px 25px rgba(255, 105, 180, 0.3)';
                    });
                    
                    photoOption.addEventListener('mouseleave', () => {
                        photoOption.style.borderColor = 'transparent';
                        photoOption.style.transform = 'translateY(0)';
                        photoOption.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.1)';
                    });
                    
                    photoGrid.appendChild(photoOption);
                });
                
                // äº‹ä»¶ç›‘å¬
                modalContent.querySelector('#skipPhotoBtn').addEventListener('click', () => {
                    document.body.removeChild(modal);
                    this.createShareImageWithPhoto(null);
                });
                
                modalContent.querySelector('#cancelSelectionBtn').addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
            }
            
            async createShareImageWithPhoto(selectedPhoto) {
                this.showNotification('æ­£åœ¨ç”Ÿæˆæµªæ¼«çºªå¿µå›¾ç‰‡... ğŸ¨', 'info');
                
                // åˆ›å»ºåˆ†äº«ç”»å¸ƒ
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // è®¾ç½®ç”»å¸ƒå°ºå¯¸ï¼ˆé€‚åˆæœ‹å‹åœˆåˆ†äº«ï¼‰
                canvas.width = 800;
                canvas.height = 1200;
                
                // åˆ›å»ºä¼˜ç¾çš„æ¸å˜èƒŒæ™¯
                const bgGradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                bgGradient.addColorStop(0, '#ff9a9e');
                bgGradient.addColorStop(0.5, '#fecfef');
                bgGradient.addColorStop(1, '#ffd1dc');
                
                ctx.fillStyle = bgGradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // æ·»åŠ ç»†è…»çš„è£…é¥°å…ƒç´ 
                this.addEnhancedDecorations(ctx, canvas);
                
                // é¡¶éƒ¨åŒºåŸŸ - æ ‡é¢˜å’Œåå­— (0-300px)
                this.drawTopSection(ctx, canvas);
                
                // ä¸­é—´åŒºåŸŸ - ä¸»ç…§ç‰‡ (300-800px)
                if (selectedPhoto) {
                    await this.drawMainPhoto(ctx, canvas, selectedPhoto);
                } else {
                    this.drawNoPhotoSection(ctx, canvas);
                }
                
                // åº•éƒ¨åŒºåŸŸ - å¤©æ•°å’Œä¿¡æ¯ (800-1200px)
                this.drawBottomSection(ctx, canvas);
                
                // æ˜¾ç¤ºåˆ†äº«æ¨¡æ€æ¡†
                this.showShareModal(canvas);
            }

            addEnhancedDecorations(ctx, canvas) {
                // æ·»åŠ ç²¾ç¾çš„è£…é¥°å…ƒç´ 
                ctx.fillStyle = 'rgba(255, 255, 255, 0.08)';
                
                // å¤§åœ†åœˆè£…é¥°
                for (let i = 0; i < 8; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    const radius = Math.random() * 60 + 40;
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // å°åœ†ç‚¹è£…é¥°
                ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
                for (let i = 0; i < 20; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    const radius = Math.random() * 8 + 3;
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // çˆ±å¿ƒè£…é¥°
                const hearts = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’˜'];
                ctx.font = '20px Arial';
                
                for (let i = 0; i < 8; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    const heart = hearts[Math.floor(Math.random() * hearts.length)];
                    
                    ctx.fillStyle = 'rgba(255, 182, 193, 0.3)';
                    ctx.fillText(heart, x, y);
                }
            }
            
            drawTopSection(ctx, canvas) {
                // ä¸»æ ‡é¢˜
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 40px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.shadowColor = 'rgba(255, 105, 180, 0.3)';
                ctx.shadowBlur = 10;
                ctx.fillText('ğŸ’• æˆ‘ä»¬çš„çˆ±æƒ…çºªå¿µæ—¥', canvas.width / 2, 80);
                
                // é‡ç½®é˜´å½±
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                
                // æƒ…ä¾£åå­—èƒŒæ™¯
                const namesBg = canvas.width * 0.8;
                const namesBgHeight = 100;
                const namesBgY = 120;
                
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                this.drawRoundRect(ctx, (canvas.width - namesBg) / 2, namesBgY, namesBg, namesBgHeight, 50);
                
                // æƒ…ä¾£åå­—
                ctx.font = 'bold 36px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.fillStyle = '#ff1744';
                ctx.textAlign = 'center';
                
                const namesY = namesBgY + namesBgHeight / 2 + 15;
                const name1X = canvas.width / 2 - 60;
                const name2X = canvas.width / 2 + 60;
                
                ctx.fillText(this.coupleName1, name1X, namesY);
                ctx.fillText(this.coupleName2, name2X, namesY);
                
                // ä¸­é—´çˆ±å¿ƒ
                ctx.fillStyle = '#ff1744';
                ctx.font = 'bold 40px Arial';
                ctx.fillText('â™¥', canvas.width / 2, namesY);
            }
            
            async drawMainPhoto(ctx, canvas, photo) {
                // ç…§ç‰‡åŒºåŸŸ
                const photoAreaY = 300;
                const photoAreaHeight = 500;
                const photoSize = 320;
                const photoX = (canvas.width - photoSize) / 2;
                const photoY = photoAreaY + (photoAreaHeight - photoSize) / 2;
                
                // ç…§ç‰‡èƒŒæ™¯è£…é¥°
                ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
                const bgPadding = 40;
                this.drawRoundRect(ctx, photoX - bgPadding, photoY - bgPadding, photoSize + bgPadding * 2, photoSize + bgPadding * 2, 25);
                
                // ç»˜åˆ¶ç…§ç‰‡
                try {
                    const img = new Image();
                    img.crossOrigin = 'anonymous';
                    img.src = photo.src;
                    
                    if (img.complete) {
                        ctx.save();
                        this.clipRoundRect(ctx, photoX, photoY, photoSize, photoSize, 20);
                        ctx.drawImage(img, photoX, photoY, photoSize, photoSize);
                        ctx.restore();
                    } else {
                        // å¦‚æœå›¾ç‰‡æœªåŠ è½½å®Œæˆï¼Œæ˜¾ç¤ºå ä½ç¬¦
                        ctx.fillStyle = 'rgba(255, 182, 193, 0.3)';
                        this.drawRoundRect(ctx, photoX, photoY, photoSize, photoSize, 20);
                        
                        ctx.fillStyle = '#ff69b4';
                        ctx.font = '60px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('ğŸ“·', photoX + photoSize / 2, photoY + photoSize / 2 + 20);
                    }
                } catch (error) {
                    // ç»˜åˆ¶å ä½ç¬¦
                    ctx.fillStyle = 'rgba(255, 182, 193, 0.3)';
                    this.drawRoundRect(ctx, photoX, photoY, photoSize, photoSize, 20);
                    
                    ctx.fillStyle = '#ff69b4';
                    ctx.font = '60px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('ğŸ“·', photoX + photoSize / 2, photoY + photoSize / 2 + 20);
                }
                
                // ç…§ç‰‡æè¿°
                ctx.fillStyle = '#666';
                ctx.font = 'italic 18px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('æˆ‘ä»¬æœ€çè´µçš„å›å¿†', canvas.width / 2, photoY + photoSize + 60);
            }
            
            drawNoPhotoSection(ctx, canvas) {
                // æ— ç…§ç‰‡æ—¶çš„è£…é¥°åŒºåŸŸ
                const decorY = 350;
                const decorHeight = 400;
                
                // è£…é¥°èƒŒæ™¯
                ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
                this.drawRoundRect(ctx, 100, decorY, canvas.width - 200, decorHeight, 30);
                
                // è£…é¥°æ–‡å­—
                ctx.fillStyle = '#ff69b4';
                ctx.font = 'bold 36px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('ğŸ’', canvas.width / 2, decorY + 100);
                
                ctx.fillStyle = '#888';
                ctx.font = 'italic 24px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('æ¯ä¸€å¤©éƒ½æ˜¯çˆ±çš„è§è¯', canvas.width / 2, decorY + 150);
                
                // å¤šä¸ªå°çˆ±å¿ƒè£…é¥°
                const hearts = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’˜', 'ğŸ’', 'ğŸ’'];
                ctx.font = '32px Arial';
                for (let i = 0; i < 6; i++) {
                    const angle = (i / 6) * Math.PI * 2;
                    const radius = 80;
                    const x = canvas.width / 2 + Math.cos(angle) * radius;
                    const y = decorY + 250 + Math.sin(angle) * radius;
                    
                    ctx.fillStyle = 'rgba(255, 105, 180, 0.7)';
                    ctx.fillText(hearts[i], x, y);
                }
            }
            
            drawBottomSection(ctx, canvas) {
                const bottomY = 850;
                
                // å¤©æ•°æ˜¾ç¤ºèƒŒæ™¯
                ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
                this.drawRoundRect(ctx, 50, bottomY, canvas.width - 100, 250, 25);
                
                // è®¡ç®—æ‹çˆ±å¤©æ•°
                const today = new Date();
                const timeDiff = today.getTime() - this.loveStartDate.getTime();
                const daysDiff = Math.floor(timeDiff / (1000 * 3600 * 24));
                
                // å¤©æ•°æ ‡é¢˜
                ctx.fillStyle = '#666';
                ctx.font = 'bold 24px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('æˆ‘ä»¬å·²ç»ç›¸çˆ±äº†', canvas.width / 2, bottomY + 50);
                
                // å¤§æ•°å­—å¤©æ•°
                ctx.fillStyle = '#ff1744';
                ctx.font = 'bold 80px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.shadowColor = 'rgba(255, 105, 180, 0.4)';
                ctx.shadowBlur = 15;
                ctx.fillText(daysDiff, canvas.width / 2, bottomY + 140);
                
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                
                // å¤©æ•°å•ä½
                ctx.fillStyle = '#ff69b4';
                ctx.font = 'bold 28px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('å¤©', canvas.width / 2, bottomY + 180);
                
                // æ—¥æœŸèŒƒå›´
                const startDateStr = this.loveStartDate.toLocaleDateString('zh-CN');
                const todayStr = today.toLocaleDateString('zh-CN');
                
                ctx.fillStyle = '#888';
                ctx.font = '18px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(`${startDateStr} - ${todayStr}`, canvas.width / 2, bottomY + 220);
                
                // åº•éƒ¨æµªæ¼«è¯­å½•
                const romanticQuotes = [
                    '"ä¸ä½ ç›¸é‡ï¼Œå¥½å¹¸è¿"',
                    '"çˆ±ä½ æ˜¯æˆ‘åšè¿‡æœ€å¥½çš„å†³å®š"',
                    '"ä½ æ˜¯æˆ‘ä»Šç”Ÿå”¯ä¸€çš„ç­”æ¡ˆ"',
                    '"ä¸ä½ åœ¨ä¸€èµ·ï¼Œæ—¶å…‰éƒ½å˜å¾—æ¸©æŸ”"'
                ];
                
                const randomQuote = romanticQuotes[Math.floor(Math.random() * romanticQuotes.length)];
                
                ctx.fillStyle = '#999';
                ctx.font = 'italic 20px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(randomQuote, canvas.width / 2, canvas.height - 80);
                
                // ç”Ÿæˆæ—¶é—´
                ctx.fillStyle = '#bbb';
                ctx.font = '16px "PingFang SC", "Microsoft YaHei", sans-serif';
                const generateTime = new Date().toLocaleDateString('zh-CN');
                ctx.fillText(`ç”Ÿæˆäº ${generateTime} Â· çˆ±æƒ…çºªå¿µå†Œ`, canvas.width / 2, canvas.height - 40);
            }

            addRomanticDecorations(ctx, canvas) {
                // æ·»åŠ æµªæ¼«è£…é¥°å…ƒç´ 
                ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
                
                // æ·»åŠ éšæœºåœ†åœˆè£…é¥°
                for (let i = 0; i < 25; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    const radius = Math.random() * 40 + 20;
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // æ·»åŠ çˆ±å¿ƒè£…é¥°
                const hearts = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’˜', 'ğŸ’', 'ğŸ’', 'ğŸ’Ÿ', 'â¤ï¸'];
                ctx.font = '30px Arial';
                
                for (let i = 0; i < 15; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    const heart = hearts[Math.floor(Math.random() * hearts.length)];
                    
                    ctx.fillStyle = 'rgba(255, 182, 193, 0.6)';
                    ctx.fillText(heart, x, y);
                }
            }
            
            async addPhotoGrid(ctx, canvas) {
                // åœ¨ä¸­é—´åŒºåŸŸæ·»åŠ ç…§ç‰‡ç½‘æ ¼
                const gridStartY = 580;
                const gridHeight = 350;
                const photoSize = 80;
                const spacing = 20;
                const cols = 6;
                const rows = 3;
                
                const gridWidth = cols * photoSize + (cols - 1) * spacing;
                const startX = (canvas.width - gridWidth) / 2;
                
                // ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                this.drawRoundRect(ctx, startX - 20, gridStartY - 20, gridWidth + 40, gridHeight + 40, 15);
                
                // ç»˜åˆ¶ç…§ç‰‡å ä½ç¬¦
                for (let row = 0; row < rows; row++) {
                    for (let col = 0; col < cols; col++) {
                        const index = row * cols + col;
                        if (index >= Math.min(this.images.length, 18)) break;
                        
                        const x = startX + col * (photoSize + spacing);
                        const y = gridStartY + row * (photoSize + spacing);
                        
                        // ç»˜åˆ¶ç›¸æ¡†
                        ctx.fillStyle = 'rgba(255, 182, 193, 0.3)';
                        ctx.strokeStyle = '#ff69b4';
                        ctx.lineWidth = 2;
                        
                        this.drawRoundRect(ctx, x, y, photoSize, photoSize, 8);
                        ctx.stroke();
                        
                        // ç»˜åˆ¶ç…§ç‰‡å ä½ç¬¦å›¾æ ‡
                        ctx.fillStyle = '#ff69b4';
                        ctx.font = '24px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('ğŸ“·', x + photoSize / 2, y + photoSize / 2 + 8);
                    }
                }
                
                // æ·»åŠ ç…§ç‰‡åŒºåŸŸæ ‡é¢˜
                ctx.font = 'bold 20px "PingFang SC", "Microsoft YaHei", sans-serif';
                ctx.fillStyle = '#666';
                ctx.textAlign = 'center';
                ctx.fillText(`æˆ‘ä»¬çš„ ${this.images.length} å¼ ç¾å¥½å›å¿†`, canvas.width / 2, gridStartY - 30);
            }
            
            showShareModal(canvas) {
                // åˆ›å»ºæ¨¡æ€æ¡†
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.85);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                    backdrop-filter: blur(15px);
                    animation: modalFadeIn 0.4s ease;
                `;
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = `
                    background: white;
                    border-radius: 30px;
                    padding: 40px;
                    max-width: 550px;
                    width: 95%;
                    max-height: 85vh;
                    overflow-y: auto;
                    box-shadow: 0 30px 100px rgba(0, 0, 0, 0.6);
                    animation: modalSlideIn 0.5s ease;
                    text-align: center;
                `;
                
                // æ·»åŠ æ¨¡æ€æ¡†å†…å®¹
                modalContent.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h3 style="color: #ff1744; font-size: 1.6rem; font-weight: 700; margin: 0;">ğŸ’• åˆ†äº«æˆ‘ä»¬çš„çˆ±æƒ…</h3>
                        <button id="closeShareModal" style="background: none; border: none; font-size: 2rem; cursor: pointer; color: #999; padding: 5px;">Ã—</button>
                    </div>
                    <div style="margin-bottom: 30px;">
                        <img id="sharePreview" style="max-width: 100%; border-radius: 20px; box-shadow: 0 20px 60px rgba(255, 105, 180, 0.4);" />
                    </div>
                    <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                        <button id="downloadShare" style="padding: 15px 30px; border: none; border-radius: 25px; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease; font-weight: 600; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #ff6b9d, #ff1744); color: white; box-shadow: 0 10px 30px rgba(255, 105, 180, 0.4);">
                            ğŸ“¥ ä¸‹è½½å›¾ç‰‡
                        </button>
                        <button id="copyShare" style="padding: 15px 30px; border: 2px solid rgba(255, 182, 193, 0.6); border-radius: 25px; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease; font-weight: 600; display: flex; align-items: center; gap: 10px; background: rgba(255, 182, 193, 0.4); color: #ff1744;">
                            ğŸ“‹ å¤åˆ¶å›¾ç‰‡
                        </button>
                    </div>
                `;
                
                // æ˜¾ç¤ºé¢„è§ˆå›¾
                const sharePreview = modalContent.querySelector('#sharePreview');
                sharePreview.src = canvas.toDataURL('image/png');
                
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬
                modalContent.querySelector('#closeShareModal').addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                modalContent.querySelector('#downloadShare').addEventListener('click', () => {
                    this.downloadShareImage(canvas);
                });
                
                modalContent.querySelector('#copyShare').addEventListener('click', () => {
                    this.copyShareImage(canvas);
                });
                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        document.body.removeChild(modal);
                    }
                });
                
                // æ·»åŠ æ¨¡æ€æ¡†åŠ¨ç”»
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes modalFadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                    @keyframes modalSlideIn {
                        from {
                            opacity: 0;
                            transform: scale(0.8) translateY(50px);
                        }
                        to {
                            opacity: 1;
                            transform: scale(1) translateY(0);
                        }
                    }
                `;
                document.head.appendChild(style);
                
                this.showNotification('æµªæ¼«çºªå¿µå›¾ç‰‡ç”Ÿæˆå®Œæˆï¼ğŸ’•', 'success');
            }
            
            downloadShareImage(canvas) {
                const dataURL = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                const fileName = `${this.coupleName1}å’Œ${this.coupleName2}çš„çˆ±æƒ…çºªå¿µ_${new Date().toLocaleDateString('zh-CN').replace(/\//g, '-')}.png`;
                link.download = fileName;
                link.href = dataURL;
                link.click();
                
                this.showNotification('å›¾ç‰‡ä¸‹è½½æˆåŠŸï¼ğŸ“¥', 'success');
            }
            
            async copyShareImage(canvas) {
                try {
                    canvas.toBlob(async (blob) => {
                        try {
                            await navigator.clipboard.write([
                                new ClipboardItem({ 'image/png': blob })
                            ]);
                            this.showNotification('å›¾ç‰‡å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ğŸ“‹', 'success');
                        } catch (error) {
                            this.fallbackCopyText();
                        }
                    });
                } catch (error) {
                    this.fallbackCopyText();
                }
            }
            
            fallbackCopyText() {
                const today = new Date();
                const timeDiff = today.getTime() - this.loveStartDate.getTime();
                const daysDiff = Math.floor(timeDiff / (1000 * 3600 * 24));
                
                const shareText = `ğŸ’• ${this.coupleName1} & ${this.coupleName2} çš„çˆ±æƒ…çºªå¿µæ—¥\n\næˆ‘ä»¬å·²ç»ç›¸çˆ±äº† ${daysDiff} å¤©ï¼\n\nä¸ä½ ç›¸é‡ï¼Œå¥½å¹¸è¿ â¤ï¸\n\n#çˆ±æƒ…çºªå¿µ #ç”œèœœæ—¶å…‰ #${daysDiff}å¤©`;
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(shareText).then(() => {
                        this.showNotification('æ–‡æœ¬å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ğŸ“‹', 'success');
                    }).catch(() => {
                        this.showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æˆªå›¾åˆ†äº«', 'warning');
                    });
                } else {
                    this.showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æˆªå›¾åˆ†äº«', 'warning');
                }
            }
            
            drawRoundRect(ctx, x, y, width, height, radius) {
                ctx.beginPath();
                ctx.moveTo(x + radius, y);
                ctx.lineTo(x + width - radius, y);
                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                ctx.lineTo(x + width, y + height - radius);
                ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                ctx.lineTo(x + radius, y + height);
                ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                ctx.lineTo(x, y + radius);
                ctx.quadraticCurveTo(x, y, x + radius, y);
                ctx.closePath();
                ctx.fill();
            }
            
            clipRoundRect(ctx, x, y, width, height, radius) {
                ctx.beginPath();
                ctx.moveTo(x + radius, y);
                ctx.lineTo(x + width - radius, y);
                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                ctx.lineTo(x + width, y + height - radius);
                ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                ctx.lineTo(x + radius, y + height);
                ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                ctx.lineTo(x, y + radius);
                ctx.quadraticCurveTo(x, y, x + radius, y);
                ctx.closePath();
                ctx.clip();
            }

            resetToStart() {
                // æ¸…ç†å®šæ—¶å™¨
                if (this.imageRotationInterval) {
                    clearInterval(this.imageRotationInterval);
                }
                
                this.images = [];
                this.updateImageCount();
                this.photoWallContainer.style.display = 'none';
                this.loveInfoSection.style.display = 'block';
                this.loveInfoSection.classList.add('fade-in');
                
                // é‡ç½®è¾“å…¥
                this.name1Input.value = '';
                this.name2Input.value = '';
                this.fileInput.value = '';
                
                // é‡ç½®æ—¥æœŸ
                const oneYearAgo = new Date();
                oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
                this.startDateInput.value = oneYearAgo.toISOString().split('T')[0];
                
                // é‡ç½®æŒ‰é’®çŠ¶æ€
                this.createWallBtn.innerHTML = `
                    <span>ğŸ’–</span>
                    <span>åˆ›å»ºæˆ‘ä»¬çš„3Då›å¿†å¢™</span>
                    <span>ğŸ’–</span>
                `;
                this.createWallBtn.disabled = true;
                this.pauseBtn.textContent = 'â¸ï¸ æš‚åœæ—‹è½¬';
                this.isPaused = false;
                this.animationSpeed = 1;
                
                this.validateInputs();
                this.showNotification('å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å¼€å§‹å•¦ ğŸ”„', 'info');
                
                // æ»šåŠ¨åˆ°é¡¶éƒ¨
                this.loveInfoSection.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }

            startFloatingHearts() {
                setInterval(() => {
                    this.createFloatingHeart();
                }, 3000);
            }

            createFloatingHeart() {
                const hearts = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’˜', 'ğŸ’', 'ğŸ’', 'ğŸ’Ÿ', 'â¤ï¸'];
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDuration = (Math.random() * 4 + 6) + 's';
                heart.style.fontSize = (Math.random() * 1 + 1.5) + 'rem';
                
                this.floatingHearts.appendChild(heart);
                
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, 10000);
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 25px;
                    border-radius: 25px;
                    font-size: 1rem;
                    font-weight: 600;
                    z-index: 10000;
                    backdrop-filter: blur(15px);
                    animation: slideInOut 4s ease forwards;
                    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
                `;
                
                // æ·»åŠ åŠ¨ç”»
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes slideInOut {
                        0% {
                            transform: translateX(100%);
                            opacity: 0;
                        }
                        15%, 85% {
                            transform: translateX(0);
                            opacity: 1;
                        }
                        100% {
                            transform: translateX(100%);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
                
                switch (type) {
                    case 'success':
                        notification.style.background = 'rgba(76, 175, 80, 0.95)';
                        notification.style.color = 'white';
                        break;
                    case 'warning':
                        notification.style.background = 'rgba(255, 152, 0, 0.95)';
                        notification.style.color = 'white';
                        break;
                    default:
                        notification.style.background = 'rgba(255, 105, 180, 0.95)';
                        notification.style.color = 'white';
                }
                
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                    if (style.parentNode) {
                        style.parentNode.removeChild(style);
                    }
                }, 4000);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            new Enhanced3DPhotoWall();
            
            // æ·»åŠ é¡µé¢åŠ è½½åŠ¨ç”»
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 1.2s ease';
                document.body.style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>
